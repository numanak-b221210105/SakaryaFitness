@{
    ViewData["Title"] = "API Test Paneli";
}

<div class="container py-5">
    <div class="card shadow border-0">
        <div class="card-header bg-primary text-white">
            <h3 class="mb-0"><i class="bi bi-hdd-network"></i> Web API Test Paneli</h3>
        </div>
        <div class="card-body bg-light">
            <p class="lead">Aşağıdaki butonlara tıklayarak yazdığınız LINQ sorgularını test edebilirsiniz.</p>
            
            <div class="d-flex gap-2 flex-wrap mb-4">
                <button onclick="getData('Antrenorler')" class="btn btn-success btn-lg">
                    <i class="bi bi-people-fill"></i> Antrenörleri Getir
                </button>

                <button onclick="getData('Hizmetler')" class="btn btn-warning btn-lg text-white">
                    <i class="bi bi-tags-fill"></i> Hizmetleri Getir
                </button>

                <button onclick="getData('DoluSaatler')" class="btn btn-danger btn-lg">
                    <i class="bi bi-calendar-check-fill"></i> Dolu Randevular
                </button>
            </div>

            <div class="card">
                <div class="card-header bg-white fw-bold">
                    <i class="bi bi-code-slash me-2"></i> API'den Gelen JSON Yanıtı:
                </div>
                <div class="card-body bg-dark">
                    <pre id="apiResult" class="text-success fw-bold m-0" style="min-height: 150px;">Henüz istek yapılmadı...</pre>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // Tek bir fonksiyon ile tüm adresleri çekebiliriz
    async function getData(endpoint) {
        const resultBox = document.getElementById("apiResult");
        resultBox.innerText = "Veriler sunucudan çekiliyor...";
        resultBox.className = "text-warning fw-bold m-0"; // Yükleniyor rengi

        try {
            // Sizin yazdığınız Controller yapısına uygun istek atıyoruz:
            const response = await fetch('/api/WebApi/' + endpoint);
            
            if (!response.ok) {
                throw new Error(`HTTP Hatası! Durum: ${response.status}`);
            }

            const data = await response.json();
            
            // Gelen veriyi güzelce formatlayıp ekrana bas
            resultBox.innerText = JSON.stringify(data, null, 4);
            resultBox.className = "text-success fw-bold m-0"; // Başarılı rengi

        } catch (error) {
            resultBox.innerText = "HATA OLUŞTU: " + error;
            resultBox.className = "text-danger fw-bold m-0"; // Hata rengi
        }
    }
</script>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">